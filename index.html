<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CRT TV</title>
    <style>
      html, body { margin: 0; height: 100%; overflow: hidden; background: #0b0b0f; }
      #hud {
        position: fixed; left: 12px; top: 12px; z-index: 10;
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 12px; color: #fff; opacity: 0.9;
        background: rgba(0,0,0,0.45); padding: 10px 12px; border-radius: 10px;
        max-width: 520px; line-height: 1.35;
      }
      canvas { display: block; }
    </style>
  </head>
  <body>
    <div id="hud">Loading…</div>

    <script type="module">
      import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js";
      import { GLTFLoader } from "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/GLTFLoader.js";

      const hud = document.getElementById("hud");

      let scene, camera, renderer, crt;
      let mouseX = 0, mouseY = 0;

      init();
      animate();

      function init() {
        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 0, 3.2);

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setClearColor(0x000000, 0); // transparent canvas over dark page bg
        document.body.appendChild(renderer.domElement);

        // Lights
        scene.add(new THREE.AmbientLight(0xffffff, 1.15));
        const dir = new THREE.DirectionalLight(0xffffff, 1.6);
        dir.position.set(5, 5, 5);
        scene.add(dir);

        // Load CRT model from SAME FOLDER as index.html
        const loader = new GLTFLoader();
        loader.load(
          "./retro_crt_tv.glb",
          (gltf) => {
            crt = gltf.scene;

            // Auto-center + auto-scale so it’s guaranteed visible
            const box = new THREE.Box3().setFromObject(crt);
            const size = new THREE.Vector3();
            box.getSize(size);
            const center = new THREE.Vector3();
            box.getCenter(center);

            // Center model at origin
            crt.position.sub(center);

            // Scale to a sane size (fit largest dimension ~1.6 units)
            const maxDim = Math.max(size.x, size.y, size.z) || 1;
            const scale = 1.6 / maxDim;
            crt.scale.setScalar(scale);

            scene.add(crt);
            hud.textContent = "Loaded ✓  (move mouse)";
          },
          (progress) => {
            if (progress.total) {
              const pct = Math.round((progress.loaded / progress.total) * 100);
              hud.textContent = `Loading… ${pct}%`;
            }
          },
          (err) => {
            console.error(err);
            hud.textContent =
              "ERROR: Couldn’t load ./retro_crt_tv.glb\n" +
              "Check the file name/path + GitHub Pages is serving it.";
          }
        );

